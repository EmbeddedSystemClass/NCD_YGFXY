/***************************************************************************************************
*FileName:Time_Data
*Description:时间数据
*Author:xsx
*Data:2016年5月6日17:02:44
***************************************************************************************************/

/***************************************************************************************************/
/******************************************头文件***************************************************/
/***************************************************************************************************/
#include	"Time_Data.h"
#include	"stm32f4xx_rtc.h"

#include	"MyMem.h"

#include 	"FreeRTOS.h"
#include 	"task.h"

#include	"string.h"
/***************************************************************************************************/
/**************************************局部变量声明*************************************************/
/***************************************************************************************************/
static MyTime_Def GB_TimeData;											//时间
static RTC_TimeTypeDef S_RTC_TimeStruct;								//临时时间
static RTC_DateTypeDef S_RTC_DateStruct;								//临时日期

/***************************************************************************************************/
/**************************************局部函数声明*************************************************/
/***************************************************************************************************/

/***************************************************************************************************/
/***************************************************************************************************/
/***************************************正文********************************************************/
/***************************************************************************************************/
/***************************************************************************************************/
/***************************************************************************************************/

/***************************************************************************************************
*FunctionName：GetGBTimeData
*Description：获取系统时间
*Input：None
*Output：None
*Author：xsx
*Data：2016年5月6日17:04:04
***************************************************************************************************/
void GetGBTimeData(MyTime_Def * temp)
{
	if(temp)
		memcpy(temp, &GB_TimeData, sizeof(MyTime_Def));
}

void UpGBTimeData(void)
{
	
	RTC_GetTime(RTC_Format_BIN, &S_RTC_TimeStruct);
	RTC_GetDate(RTC_Format_BIN, &S_RTC_DateStruct);
	
	GB_TimeData.year = S_RTC_DateStruct.RTC_Year;
	GB_TimeData.month = S_RTC_DateStruct.RTC_Month;
	GB_TimeData.day = S_RTC_DateStruct.RTC_Date;
	GB_TimeData.hour = S_RTC_TimeStruct.RTC_Hours;
	GB_TimeData.min = S_RTC_TimeStruct.RTC_Minutes;
	GB_TimeData.sec = S_RTC_TimeStruct.RTC_Seconds;
}
