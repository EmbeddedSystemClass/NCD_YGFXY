/***************************************************************************************************
*FileName:
*Description:
*Author: xsx_kair
*Data:
***************************************************************************************************/

/***************************************************************************************************/
/******************************************Header List**********************************************/
/***************************************************************************************************/
#include	"System_Data.h"

#include	"CRC16.h"

#include	<string.h>
/***************************************************************************************************/
/***************************************************************************************************/
/***************************************************************************************************/

static TestData	S_TestData;										//测试数据,用于纽康度生物实验室使用

static unsigned char S_TestStatus = 0;							//测试状态

static unsigned char GB_BarCode[100];							//条码枪数据

static MyTime_Def GB_Time;											//系统时间

static NetData GB_NetData;														//设备网络数据
/***************************************************************************************************/
/***************************************************************************************************/
/***************************************************************************************************/

/***************************************************************************************************/
/***************************************************************************************************/
/***************************************************************************************************/
/****************************************File Start*************************************************/
/***************************************************************************************************/
/***************************************************************************************************/

/*********************************************************************************************/
/*********************************************************************************************/
/*********************************************************************************************/
/*********************************************************************************************/
/*********************************************************************************************/


/*********************************************************************************************/
/*********************************************************************************************/
/*********************************************************************************************/
/*********************************************************************************************/
/*********************************************************************************************/
void * GetTestDataForLab(void)
{
	return &S_TestData;
}

void SetTestStatusFlorLab(unsigned char status)
{
	S_TestStatus = status;
}

unsigned char GetTestStatusFlorLab(void)
{
	return S_TestStatus;
}

/*********************************************************************************************/
/*********************************************************************************************/
/*********************************************************************************************/
/*********************************************************************************************/
/*********************************************************************************************/
void GetGB_BarCode(void *buf)
{
	memcpy(buf, GB_BarCode, 100);
}

void SetGB_BarCode(void *buf)
{
	memset(GB_BarCode, 0, 100);
	memcpy(GB_BarCode, buf, 100);	
}

/*********************************************************************************************/
/*********************************************************************************************/
/*********************************************************************************************/
/*********************************************************************************************/
/*********************************************************************************************/

void GetGB_Time(void * time)
{
	memcpy(time, &GB_Time, sizeof(MyTime_Def));
}

void SetGB_Time(void * time)
{	
	memcpy(&GB_Time, time, sizeof(MyTime_Def));
}

/*********************************************************************************************/
/*********************************************************************************************/
/*********************************************************************************************/
/*********************************************************************************************/
/*********************************************************************************************/
void GetGB_NetConfigureData(NetData * netdata)
{
	if(GB_NetData.crc != CalModbusCRC16Fun1(&GB_NetData, sizeof(NetData)-2))
	{
		GB_NetData.ipmode = DHCP_Mode;
		GB_NetData.myip.ip_1 = 0;
		GB_NetData.myip.ip_2 = 0;
		GB_NetData.myip.ip_3 = 0;
		GB_NetData.myip.ip_4 = 0;
		
		GB_NetData.crc = CalModbusCRC16Fun1(&GB_NetData, sizeof(NetData)-2);
	}
	
	memcpy(netdata, &GB_NetData, sizeof(NetData));
}

void SetGB_NetConfigureData(NetData * netdata)
{
	memcpy(&GB_NetData, netdata, sizeof(NetData));
}

NetIP_Type GetGB_IpModeData(void)
{
	if(GB_NetData.crc == CalModbusCRC16Fun1(&GB_NetData, sizeof(NetData)-2))
		return GB_NetData.ipmode;
	else
		return DHCP_Mode;
}
/****************************************end of file************************************************/
